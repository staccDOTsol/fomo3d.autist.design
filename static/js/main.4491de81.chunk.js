(this["webpackJsonpcandy-machine-mint"]=this["webpackJsonpcandy-machine-mint"]||[]).push([[0],{145:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r="item",a="marker"},253:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="matches"},478:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="namespace"},479:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="player"},480:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var r=n(29),a=n(50),c=n(49);function i(t,n,i,o){var s=[{pubkey:n,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:r.web3.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:a.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:r.web3.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return new r.web3.TransactionInstruction({keys:s,programId:c.e,data:e.from([])})}}).call(this,n(6).Buffer)},49:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return l}));var r=n(29),a=new r.web3.PublicKey("nameAxQRRBnd4kLfsVoZBBXfrByZdZTkh8mULLxLyqV"),c=new r.web3.PublicKey("itemX1XWs9dK8T2Zca4vEEPfCAhRc7yvYFntPjTTVx6"),i=new r.web3.PublicKey("p1exdMJcjVao65QdewkaZRUnU6VPSXhus9n2GzWfh98"),o=new r.web3.PublicKey("mtchsiT6WoLQ62fwCoiHMCfXJzogtfru4ovY8tXKrjJ"),s=(new r.web3.PublicKey("So11111111111111111111111111111111111111112"),new r.web3.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA")),u=new r.web3.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),l=new r.web3.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s")},505:function(e,t,n){},506:function(e,t,n){},511:function(e,t){},512:function(e,t){},523:function(e,t){},524:function(e,t){},600:function(e,t){},601:function(e,t){},616:function(e,t){},617:function(e,t){},65:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"b",(function(){return h})),n.d(t,"f",(function(){return d}));var r=n(1),a=n(3),c=n(29),i=n(49),o=n(145),s=n(253),u=(n(478),n(479)),l=function(){var e=Object(a.a)(Object(r.a)().mark((function e(t,n){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.web3.PublicKey.findProgramAddress([n.toBuffer(),i.g.toBuffer(),t.toBuffer()],i.e);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),b=function(){var t=Object(a.a)(Object(r.a)().mark((function t(n){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.web3.PublicKey.findProgramAddress([e.from(s.a),n.toBuffer()],i.b);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),p=function(){var t=Object(a.a)(Object(r.a)().mark((function t(n,a,o){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.web3.PublicKey.findProgramAddress([e.from(s.a),n.toBuffer(),a.toBuffer(),o.toBuffer()],i.b);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),f=function(){var t=Object(a.a)(Object(r.a)().mark((function t(n,a){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.web3.PublicKey.findProgramAddress([e.from(s.a),a.toBuffer(),n.toBuffer()],i.b);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),h=function(){var t=Object(a.a)(Object(r.a)().mark((function t(n,a){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.web3.PublicKey.findProgramAddress([e.from(o.b),n.toBuffer(),a.toArrayLike(e,"le",8)],i.a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),d=function(){var t=Object(a.a)(Object(r.a)().mark((function t(n,a){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.web3.PublicKey.findProgramAddress([e.from(u.a),n.toBuffer(),a.toArrayLike(e,"le",8)],i.d);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}).call(this,n(6).Buffer)},691:function(e,t){},693:function(e,t){},703:function(e,t){},705:function(e,t){},732:function(e,t){},734:function(e,t){},739:function(e,t){},741:function(e,t){},748:function(e,t){},760:function(e,t){},763:function(e,t){},878:function(e,t){},880:function(e,t){},891:function(e,t){},898:function(e,t){},899:function(e,t,n){"use strict";n.r(t);var r=n(4),a=n.n(r),c=n(58),i=n.n(c),o=(n(505),n(506),n(18)),s=n(11),u=n(1),l=n(3),b=n(13),p=n(144),f=n(8),h=n(467),d=n(9),m=n(50),j=n(84),O=n(85),v=n(247),g=n(948),w=n(946),x=n(945),y=n(196),k=n.n(y),P=n(5),T=n(7),K=n(29),B=n(477),M=n.n(B),S=n(49),A=n(65),R=n(72),E=n.n(R),I=[{name:"mainnet-beta",url:"https://api.metaplex.solana.com/"},{name:"testnet",url:Object(d.clusterApiUrl)("testnet")},{name:"mainnet-beta",url:Object(d.clusterApiUrl)("mainnet-beta")}],N=I[2];function C(e){var t,n=Object(o.a)(I);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.name===e)return r.url}}catch(a){n.e(a)}finally{n.f()}return N.url}var W=function(){return(new Date).getTime()/1e3};function U(e){return new Promise((function(t){return setTimeout(t,e)}))}var _,L,V;function Y(e,t,n,r){return D.apply(this,arguments)}function D(){return D=Object(l.a)(Object(u.a)().mark((function e(t,n,r,a){var c,i,o=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=o.length>4&&void 0!==o[4]?o[4]:"singleGossip",i=new d.Transaction,r.forEach((function(e){return i.add(e)})),e.next=5,t.getLatestBlockhash(c);case 5:return i.recentBlockhash=e.sent.blockhash,i.feePayer=n.publicKey,a.length>0&&i.partialSign.apply(i,Object(s.a)(a)),n.signTransaction(i),e.abrupt("return",z({connection:t,signedTransaction:i}));case 10:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}function z(e){return F.apply(this,arguments)}function F(){return(F=Object(l.a)(Object(u.a)().mark((function e(t){var n,r,a,c,i,o,s,b,p,f,h,d,m;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.signedTransaction,r=t.connection,a=t.timeout,c=void 0===a?15e3:a,i=n.serialize(),o=W(),s=0,e.next=6,r.sendRawTransaction(i,{skipPreflight:!0});case 6:return b=e.sent,E.a.debug("Started awaiting confirmation for",b),p=!1,Object(l.a)(Object(u.a)().mark((function e(){return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p||!(W()-o<c)){e.next=6;break}return r.sendRawTransaction(i,{skipPreflight:!0}),e.next=4,U(500);case 4:e.next=0;break;case 6:case"end":return e.stop()}}),e)})))(),e.prev=10,e.next=13,q(b,c,r,"recent",!0);case 13:if(f=e.sent){e.next=16;break}throw new Error("Timed out awaiting confirmation on transaction");case 16:if(!f.err){e.next=19;break}throw E.a.error(f.err),new Error("Transaction failed: Custom instruction error");case 19:s=(null===f||void 0===f?void 0:f.slot)||0,e.next=49;break;case 22:if(e.prev=22,e.t0=e.catch(10),E.a.error("Timeout Error caught",e.t0),!e.t0.timeout){e.next=27;break}throw new Error("Timed out awaiting confirmation on transaction");case 27:return h=null,e.prev=28,e.next=31,J(r,n,"single");case 31:h=e.sent.value,e.next=37;break;case 34:e.prev=34,e.t1=e.catch(28),E.a.error("Simulate Transaction error",e.t1);case 37:if(!h||!h.err){e.next=48;break}if(!h.logs){e.next=47;break}d=h.logs.length-1;case 40:if(!(d>=0)){e.next=47;break}if(!(m=h.logs[d]).startsWith("Program log: ")){e.next=44;break}throw new Error("Transaction failed: "+m.slice("Program log: ".length));case 44:--d,e.next=40;break;case 47:throw new Error(JSON.stringify(h.err));case 48:E.a.error("Got this far.");case 49:return e.prev=49,p=!0,e.finish(49);case 52:return E.a.debug("Latency (ms)",b,W()-o),e.abrupt("return",{txid:b,slot:s});case 54:case"end":return e.stop()}}),e,null,[[10,22,49,52],[28,34]])})))).apply(this,arguments)}function J(e,t,n){return G.apply(this,arguments)}function G(){return(G=Object(l.a)(Object(u.a)().mark((function e(t,n,r){var a,c,i,o,s;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getLatestBlockhash(t._disableBlockhashCaching);case 2:return n.recentBlockhash=e.sent,a=n.serializeMessage(),c=n._serialize(a),i=c.toString("base64"),o=[i,{encoding:"base64",commitment:r}],e.next=10,t._rpcRequest("simulateTransaction",o);case 10:if(!(s=e.sent).error){e.next=13;break}throw new Error("failed to simulate transaction: "+s.error.message);case 13:return e.abrupt("return",s.result);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t,n){return Z.apply(this,arguments)}function Z(){return Z=Object(l.a)(Object(u.a)().mark((function e(t,n,r){var a,c,i,o,s,b=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=b.length>3&&void 0!==b[3]?b[3]:"recent",c=b.length>4&&void 0!==b[4]&&b[4],i=!1,o={slot:0,confirmations:0,err:null},s=0,e.next=7,new Promise(function(){var e=Object(l.a)(Object(u.a)().mark((function e(b,p){return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout((function(){i||(i=!0,E.a.warn("Rejecting for timeout..."),p({timeout:!0}))}),n);try{s=r.onSignature(t,(function(e,t){i=!0,o={err:e.err,slot:t.slot,confirmations:0},e.err?(E.a.warn("Rejected via websocket",e.err),p(o)):(E.a.debug("Resolved via websocket",e),b(o))}),a)}catch(f){i=!0,E.a.error("WS error in setup",t,f)}case 2:if(i||!c){e.next=8;break}return Object(l.a)(Object(u.a)().mark((function e(){var n;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.getSignatureStatuses([t]);case 3:n=e.sent,o=n&&n.value[0],i||(o?o.err?(E.a.error("REST error for",t,o),i=!0,p(o.err)):o.confirmations?(E.a.debug("REST confirmation for",t,o),i=!0,b(o)):E.a.debug("REST no confirmations for",t,o):E.a.debug("REST null result for",t,o)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),i||E.a.error("REST connection error: txid",t,e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))(),e.next=6,U(2e3);case 6:e.next=2;break;case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 7:return o=e.sent,r._subscriptionsByHash[s]&&r.removeSignatureListener(s),i=!0,E.a.debug("Returning status",o),e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)}))),Z.apply(this,arguments)}!function(e){e[e.Draft=0]="Draft",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started",e[e.Finalized=3]="Finalized",e[e.PaidOut=4]="PaidOut",e[e.Deactivated=5]="Deactivated"}(_||(_={})),function(e){e[e.PlayerToPlayer=0]="PlayerToPlayer",e[e.PlayerToEntrant=1]="PlayerToEntrant",e[e.Normal=2]="Normal"}(L||(L={})),function(e){e[e.Player=0]="Player",e[e.Item=1]="Item",e[e.Any=2]="Any"}(V||(V={}));var Q=n(480);function X(e){e.tokenEntryValidation&&(e.tokenEntryValidation=e.tokenEntryValidation.map((function(e){var t=Object(f.a)({},e.filter);return Object.keys(t).forEach((function(e){Object.keys(t[e]).forEach((function(n){"string"===typeof t[e][n]&&(t[e][n]=new K.web3.PublicKey(t[e][n]))}))})),e.filter=t,e.validation&&"string"===typeof e.validation.key&&(e.validation.key=new K.web3.PublicKey(e.validation.key),e.validation.code=new K.BN(e.validation.code)),e})))}var H=Object(P.a)((function e(t){Object(T.a)(this,e),this.program=void 0,this.key=void 0,this.object=void 0,this.data=void 0,this.program=t.program,this.key=t.key,this.object=t.object,this.data=t.data})),$=function(){function e(t){Object(T.a)(this,e),this.id=void 0,this.program=void 0,this.id=t.id,this.program=t.program}return Object(P.a)(e,[{key:"createMatch",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n,r,a,c=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.length>1&&void 0!==c[1]?c[1]:{},c.length>2&&void 0!==c[2]?c[2]:{},e.next=4,Object(A.c)(t.winOracle);case 4:return n=e.sent,r=Object(b.a)(n,2),a=r[0],r[1],X(t),e.next=11,this.program.methods.createMatch(t).accounts({matchInstance:a,payer:this.program.provider.wallet.publicKey,systemProgram:d.SystemProgram.programId,rent:K.web3.SYSVAR_RENT_PUBKEY}).instruction();case 11:return e.t0=e.sent,e.t1=[e.t0],e.t2=[],e.abrupt("return",{instructions:e.t1,signers:e.t2});case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disburseTokensByOracle",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n,r){var a,c,i,o,s,l,p,f,h,m;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(A.c)(n.winOracle);case 2:return a=e.sent[0],c=r.tokenDelta,e.next=6,Object(A.d)(n.winOracle,c.mint,c.from);case 6:return i=e.sent,o=Object(b.a)(i,2),s=o[0],o[1],l=c.to,e.next=13,this.program.provider.connection.getAccountInfo(l);case 13:if(p=e.sent,f=[],p.owner.equals(S.g)){e.next=24;break}return h=l,e.next=19,Object(A.a)(c.mint,l);case 19:return l=e.sent[0],e.next=22,this.program.provider.connection.getAccountInfo(l);case 22:(m=e.sent)&&0!=m.data.length||f.unshift(Object(Q.a)(l,this.program.provider.wallet.publicKey,h,c.mint));case 24:return e.t0=f,e.next=27,this.program.methods.disburseTokensByOracle(t).accounts({matchInstance:a,tokenAccountEscrow:s,tokenMint:c.mint,originalSender:c.from,destinationTokenAccount:l,winOracle:n.winOracle,tokenProgram:S.g,systemProgram:d.SystemProgram.programId,rent:K.web3.SYSVAR_RENT_PUBKEY}).instruction();case 27:return e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.abrupt("return",{instructions:f,signers:[]});case 30:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"drainMatch",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n,r){var a;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(A.c)(r.winOracle);case 2:return a=e.sent[0],e.next=5,this.program.methods.drainMatch().accounts({matchInstance:a,authority:this.program.provider.wallet.publicKey,receiver:n.receiver||this.program.provider.wallet.publicKey}).instruction();case 5:return e.t0=e.sent,e.t1=[e.t0],e.t2=[],e.abrupt("return",{instructions:e.t1,signers:e.t2});case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"drainOracle",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n){var r,a,c,i,o,s,l=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.length>2&&void 0!==l[2]?l[2]:{},e.next=3,Object(A.e)(new K.web3.PublicKey(t.seed),new K.web3.PublicKey(t.authority));case 3:return r=e.sent,a=Object(b.a)(r,2),c=a[0],a[1],e.next=9,Object(A.c)(c);case 9:return i=e.sent,o=Object(b.a)(i,2),s=o[0],o[1],e.next=15,this.program.methods.drainOracle(Object(f.a)(Object(f.a)({},t),{},{seed:new K.web3.PublicKey(t.seed)})).accounts({matchInstance:s,authority:this.program.provider.wallet.publicKey,receiver:n.receiver||this.program.provider.wallet.publicKey,oracle:c}).instruction();case 15:return e.t0=e.sent,e.t1=[e.t0],e.t2=[],e.abrupt("return",{instructions:e.t1,signers:e.t2});case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateMatch",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n){var r,a=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.length>2&&void 0!==a[2]?a[2]:{},e.next=3,Object(A.c)(n.winOracle);case 3:return r=e.sent[0],X(t),e.next=7,this.program.methods.updateMatch(t).accounts({matchInstance:r,winOracle:n.winOracle,authority:this.program.provider.wallet.publicKey}).instruction();case 7:return e.t0=e.sent,e.t1=[e.t0],e.t2=[],e.abrupt("return",{instructions:e.t1,signers:e.t2});case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"leaveMatch",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n,r){var a,c,i,o,s,l;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(A.c)(r.winOracle);case 2:return a=e.sent[0],e.next=5,Object(A.a)(n.tokenMint,n.receiver);case 5:return c=e.sent[0],e.next=8,Object(A.d)(r.winOracle,n.tokenMint,this.program.provider.wallet.publicKey);case 8:return i=e.sent,o=Object(b.a)(i,2),s=o[0],o[1],l=[],e.next=15,this.program.methods.leaveMatch(t).accounts({matchInstance:a,tokenAccountEscrow:s,tokenMint:n.tokenMint,destinationTokenAccount:c,receiver:this.program.provider.wallet.publicKey,tokenProgram:S.g}).instruction();case 15:return e.t0=e.sent,e.t1=[e.t0],e.t2=l,e.abrupt("return",{instructions:e.t1,signers:e.t2});case 19:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"joinMatch",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n,r){var a,c,i,o,s,l,p;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(A.c)(r.winOracle);case 2:if(a=e.sent[0],e.t0=n.sourceTokenAccount,e.t0){e.next=8;break}return e.next=7,Object(A.a)(n.tokenMint,this.program.provider.wallet.publicKey);case 7:e.t0=e.sent[0];case 8:return c=e.t0,i=n.tokenTransferAuthority||K.web3.Keypair.generate(),e.next=12,Object(A.d)(r.winOracle,n.tokenMint,this.program.provider.wallet.publicKey);case 12:if(o=e.sent,s=Object(b.a)(o,2),l=s[0],s[1],p=[i],e.t1=m.Token.createApproveInstruction(S.g,c,i.publicKey,this.program.provider.wallet.publicKey,[],t.amount.toNumber()),e.t2=this.program.methods.joinMatch(t),e.t3=a,e.t4=i.publicKey,e.t5=l,e.t6=n.tokenMint,e.t7=c,r.sourceType!=V.Any){e.next=28;break}e.t8=d.SystemProgram.programId,e.next=38;break;case 28:if(r.sourceType!=V.Item){e.next=34;break}return e.next=31,Object(A.b)(n.tokenMint,r.index);case 31:e.t9=e.sent[0],e.next=37;break;case 34:return e.next=36,Object(A.f)(n.tokenMint,r.index);case 36:e.t9=e.sent[0];case 37:e.t8=e.t9;case 38:return e.t10=e.t8,e.t11=this.program.provider.wallet.publicKey,e.t12=d.SystemProgram.programId,e.t13=n.validationProgram||d.SystemProgram.programId,e.t14=S.g,e.t15=K.web3.SYSVAR_RENT_PUBKEY,e.t16={matchInstance:e.t3,tokenTransferAuthority:e.t4,tokenAccountEscrow:e.t5,tokenMint:e.t6,sourceTokenAccount:e.t7,sourceItemOrPlayerPda:e.t10,payer:e.t11,systemProgram:e.t12,validationProgram:e.t13,tokenProgram:e.t14,rent:e.t15},e.next=47,e.t2.accounts.call(e.t2,e.t16).signers(p).instruction();case 47:return e.t17=e.sent,e.t18=m.Token.createRevokeInstruction(S.g,c,this.program.provider.wallet.publicKey,[]),e.t19=[e.t1,e.t17,e.t18],e.t20=p,e.abrupt("return",{instructions:e.t19,signers:e.t20});case 52:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"updateMatchFromOracle",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(){var t,n,r=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>0&&void 0!==r[0]?r[0]:{},t=r.length>1?r[1]:void 0,r.length>2&&void 0!==r[2]?r[2]:{},e.next=5,Object(A.c)(t.winOracle);case 5:return n=e.sent[0],e.next=8,this.program.methods.updateMatchFromOracle().accounts({matchInstance:n,winOracle:t.winOracle,authority:this.program.provider.wallet.publicKey,clock:K.web3.SYSVAR_CLOCK_PUBKEY}).instruction();case 8:return e.t0=e.sent,e.t1=[e.t0],e.t2=[],e.abrupt("return",{instructions:e.t1,signers:e.t2});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createOrUpdateOracle",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n,r,a,c,i=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.length>1&&void 0!==i[1]?i[1]:{},i.length>2&&void 0!==i[2]?i[2]:{},e.next=4,Object(A.e)(new K.web3.PublicKey(t.seed),t.authority);case 4:return n=e.sent,r=Object(b.a)(n,2),a=r[0],r[1],c=t.tokenTransfers?t.tokenTransfers.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{from:new K.web3.PublicKey(e.from),to:e.to?new K.web3.PublicKey(e.to):null,mint:new K.web3.PublicKey(e.mint),amount:new K.BN(e.amount)})})):null,e.next=11,this.program.methods.createOrUpdateOracle(Object(f.a)(Object(f.a)({},t),{},{tokenTransfers:c,seed:new K.web3.PublicKey(t.seed)})).accounts({oracle:a,payer:this.program.provider.wallet.publicKey,systemProgram:d.SystemProgram.programId,rent:K.web3.SYSVAR_RENT_PUBKEY}).instruction();case 11:return e.t0=e.sent,e.t1=[e.t0],e.t2=[],e.abrupt("return",{instructions:e.t1,signers:e.t2});case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ee=function(){function e(t){Object(T.a)(this,e),this.id=void 0,this.program=void 0,this.instruction=void 0,this.id=t.id,this.program=t.program,this.instruction=new $({id:this.id,program:this.program})}return Object(P.a)(e,[{key:"fetchMatch",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n,r;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(A.c)(t);case 2:return n=e.sent[0],e.next=5,this.program.account.match.fetch(n);case 5:return r=e.sent,e.abrupt("return",new H({program:this,key:n,data:r.data,object:r}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchOracle",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n,r;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.program.provider.connection.getAccountInfo(t);case 2:return n=e.sent,e.next=5,this.program.account.winOracle.coder.accounts.decode("WinOracle",n.data);case 5:return r=e.sent,e.abrupt("return",new H({program:this,key:t,data:n.data,object:r}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createMatch",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n,r,a,c=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.length>1&&void 0!==c[1]?c[1]:{},c.length>2?c[2]:void 0,e.next=4,this.instruction.createMatch(t);case 4:return n=e.sent,r=n.instructions,a=n.signers,e.next=9,Y(this.program.provider.connection,this.program.provider.wallet,r,a);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disburseTokensByOracle",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n,r){var a,c,i;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.instruction.disburseTokensByOracle(t,n,r);case 2:return a=e.sent,c=a.instructions,i=a.signers,e.abrupt("return",{instructions:c,signers:i});case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"drainMatch",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n,r){var a,c,i;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.instruction.drainMatch(t,n,r);case 2:return a=e.sent,c=a.instructions,i=a.signers,e.next=7,Y(this.program.provider.connection,this.program.provider.wallet,c,i);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"drainOracle",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n){var r,a,c,i=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.length>2&&void 0!==i[2]?i[2]:{},e.next=3,this.instruction.drainOracle(t,n);case 3:return r=e.sent,a=r.instructions,c=r.signers,e.next=8,Y(this.program.provider.connection,this.program.provider.wallet,a,c);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"joinMatch",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n,r){var a,c,i;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.instruction.joinMatch(t,n,r);case 2:return a=e.sent,c=a.instructions,i=a.signers,e.abrupt("return",{instructions:c,signers:i});case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"leaveMatch",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n,r){var a,c,i;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.instruction.leaveMatch(t,n,r);case 2:return a=e.sent,c=a.instructions,i=a.signers,e.abrupt("return",{instructions:c,signers:i});case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"updateMatch",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n){var r,a,c,i=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.length>2&&void 0!==i[2]?i[2]:{},e.next=3,this.instruction.updateMatch(t,n);case 3:return r=e.sent,a=r.instructions,c=r.signers,e.next=8,Y(this.program.provider.connection,this.program.provider.wallet,a,c);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateMatchFromOracle",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(){var t,n,r,a,c,i=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},n=i.length>1?i[1]:void 0,i.length>2&&void 0!==i[2]?i[2]:{},e.next=5,this.instruction.updateMatchFromOracle(t,n);case 5:return r=e.sent,a=r.instructions,c=r.signers,e.next=10,Y(this.program.provider.connection,this.program.provider.wallet,a,c);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createOrUpdateOracle",value:function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n,r,a,c=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.length>1&&void 0!==c[1]?c[1]:{},c.length>2&&void 0!==c[2]?c[2]:{},e.next=4,this.instruction.createOrUpdateOracle(t);case 4:return n=e.sent,r=n.instructions,a=n.signers,e.next=9,Y(this.program.provider.connection,this.program.provider.wallet,r,a);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function te(e,t,n){return ne.apply(this,arguments)}function ne(){return(ne=Object(l.a)(Object(u.a)().mark((function e(t,n,r){var a,c,i,o;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r&&E.a.debug("USING CUSTOM URL",r),a=new K.web3.Connection(r||C(n)),t instanceof K.web3.Keypair&&(t=new M.a(t)),c=new K.AnchorProvider(a,t,{preflightCommitment:"recent"}),e.next=6,K.Program.fetchIdl(S.b,c);case 6:return i=e.sent,o=new K.Program(i,S.b,c),e.abrupt("return",new ee({id:S.b,program:o}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re,ae,ce=n(28),ie=(Object(O.a)(x.a)((function(e){var t=e.theme;return Object(f.a)(Object(f.a)({},t.typography.body2),{},{padding:t.spacing(1),textAlign:"center",color:"purple"})})),Object(O.a)(v.a)(re||(re=Object(p.a)([""])))),oe=Object(O.a)(g.a)((function(e){var t=e.theme;return Object(f.a)(Object(f.a)({},t.typography.body2),{},{padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})}));Object(O.a)(g.a)((function(e){var t=e.theme;return Object(f.a)(Object(f.a)({},t.typography.body2),{},{padding:t.spacing(1),textAlign:"center",color:"black"})}));!function(e){e[e.PreBet=0]="PreBet",e[e.PostBet=1]="PostBet",e[e.RevealPending=2]="RevealPending"}(ae||(ae={}));var se,ue="https://ssc-dao.genesysgo.net/",le=function(){var e,t,n=Object(r.useState)(),a=Object(b.a)(n,2),c=a[0],i=a[1],p=Object(r.useState)(1),f=Object(b.a)(p,2),O=f[0],v=f[1],g=Object(r.useState)("jare...gm"),y=Object(b.a)(g,2),P=y[0],T=y[1],B=Object(r.useState)("jare...gm"),M=Object(b.a)(B,2),S=M[0],R=M[1],E=Object(r.useState)(0),I=Object(b.a)(E,2),N=I[0],C=I[1],W=Object(j.c)(),U=(Object(j.d)(),Object(r.useState)(ae.PreBet)),_=Object(b.a)(U,2),L=_[0],V=_[1],Y=Object(r.useState)(null),D=Object(b.a)(Y,2),z=(D[0],D[1],Object(r.useState)("")),F=Object(b.a)(z,2),J=F[0],G=F[1],q=new d.Connection(ue,{commitment:"recent",confirmTransactionInitialTimeout:36e4});if(W){var Z=new K.AnchorProvider(q,W,{preflightCommitment:"processed"});t=new h.FanoutClient(q,Z.wallet)}var Q,X=!1;setTimeout(Object(l.a)(Object(u.a)().mark((function e(){return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.get("https://fuckcors2.autist.design/wat");case 3:se=e.sent,T(se.data.winnerlol),R(new Date(se.data.wenEnd).toString()),C(se.data.thePot/Math.pow(10,5)),Q=1*Math.floor(se.data.template.tokensToJoin[0].amount/Math.pow(10,5))*.02,v(1*Math.floor(se.data.template.tokensToJoin[0].amount/Math.pow(10,5))+Q),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),1),setInterval(Object(l.a)(Object(u.a)().mark((function e(){var t;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.get("https://fuckcors2.autist.design/wat");case 3:t=e.sent,T(t.data.winnerlol),R(new Date(t.data.wenEnd).toString()),Q=1*Math.floor(t.data.template.tokensToJoin[0].amount/Math.pow(10,5))*.02,v(1*Math.floor(t.data.template.tokensToJoin[0].amount/Math.pow(10,5))+Q),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),65e3);var H=function(){var n=Object(l.a)(Object(u.a)().mark((function n(){var r,a,i,o,b,p,f,h,j,g,w;return Object(u.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(W){n.next=2;break}return n.abrupt("return");case 2:if(O){n.next=4;break}return n.abrupt("return");case 4:if(c){n.next=6;break}return n.abrupt("return");case 6:return G(""),V(ae.RevealPending),console.log({player:W.publicKey.toBase58(),risk:O*Math.pow(10,5),env:"mainnet-beta"}),n.prev=9,n.next=12,k.a.get("https://fuckcors2.autist.design/becomeWinner",{params:{player:W.publicKey.toBase58(),risk:O*Math.pow(10,5),env:"mainnet-beta"}});case 12:a=n.sent,n.next=22;break;case 15:return n.prev=15,n.t0=n.catch(9),console.log(n.t0),v(O+1),n.next=21,k.a.get("https://fuckcors2.autist.design/becomeWinner",{params:{player:W.publicKey.toBase58(),risk:O*Math.pow(10,5),env:"mainnet-beta"}});case 21:a=n.sent;case 22:return i=a.data,console.log(i),n.next=26,Object(A.e)(new K.web3.PublicKey(i.oracleState.seed),new K.web3.PublicKey(i.oracleState.authority));case 26:return o=n.sent[0],console.log(o.toBase58()),console.log(o.toBase58()),console.log(o.toBase58()),console.log(o.toBase58()),Object(K.setProvider)(new K.AnchorProvider(q,W,K.AnchorProvider.defaultOptions())),n.next=34,te(W,"mainnet-beta",ue);case 34:return b=n.sent,0,p=i.tokensToJoin[0],setTimeout(Object(l.a)(Object(u.a)().mark((function e(){return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:V(ae.PreBet);case 1:case"end":return e.stop()}}),e)}))),9999),n.next=40,b.joinMatch({amount:new K.BN(1.01*p.amount),tokenEntryValidation:null,tokenEntryValidationProof:null},{tokenMint:new K.web3.PublicKey(p.mint),sourceTokenAccount:null,tokenTransferAuthority:null,validationProgram:p.validationProgram?new K.web3.PublicKey(p.validationProgram):null},{winOracle:o,sourceType:p.sourceType,index:new K.BN(p.index)});case 40:return f=n.sent,h=(r=new K.web3.Transaction).add.apply(r,Object(s.a)(f.instructions)),console.log(Q),console.log(Q),console.log(Q),n.next=47,m.Token.createTransferInstruction(m.TOKEN_PROGRAM_ID,e,new d.PublicKey("GzecHD1g2vfNuRVC6p8D5jMYK4KPB3JnLoCkwssMZwuc"),W.publicKey,[],Q*Math.pow(10,5));case 47:return j=n.sent,n.prev=48,n.next=51,t.unstakeTokenMemberInstructions({fanout:fanout,member:new d.PublicKey(req.query.player),payer:walletKeyPair.publicKey});case 51:g=n.sent,h.add.apply(h,Object(s.a)(g.instructions)),n.next=58;break;case 55:n.prev=55,n.t1=n.catch(48),console.log(n.t1);case 58:return h.add(j),h.feePayer=W.publicKey,n.next=62,q.getRecentBlockhash();case 62:return h.recentBlockhash=n.sent.blockhash,n.next=65,h.sign.apply(h,Object(s.a)(f.signers));case 65:return n.next=67,W.signTransaction(h);case 67:return n.next=69,q.sendRawTransaction(h.serialize(),{skipPreflight:!0});case 69:w=n.sent,console.log(w),X=!1,setTimeout(Object(l.a)(Object(u.a)().mark((function e(){var t,n,r,a,c,i,p;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(o.toBase58()),e.next=3,b.fetchOracle(o);case 3:if(t=e.sent,X){e.next=49;break}if(console.log(L),console.log(t.object),!(t.object.tokenTransfers.length>0)){e.next=49;break}X=!0,n=t.object.tokenTransfers[0],e.prev=10,e.next=42;break;case 15:if((e.t1=e.t0()).done){e.next=32;break}if(a=e.t1.value,(n=t.object.tokenTransfers[a]).from!=W.publicKey.toBase58()&&n.from!=W.publicKey){e.next=30;break}return console.log(n),n.amount=parseFloat(n.amount),console.log(n),console.log(parseFloat(n.amount)),n.amount>0&&!0,!1,e.next=27,b.disburseTokensByOracle({tokenDeltaProofInfo:null},{winOracle:o},{tokenDelta:n});case 27:c=e.sent,i=c.instructions,r.add.apply(r,Object(s.a)(i));case 30:e.next=15;break;case 32:return r.feePayer=W.publicKey,e.next=35,q.getRecentBlockhash();case 35:return r.recentBlockhash=e.sent.blockhash,e.next=38,W.signTransaction(r);case 38:return e.next=40,q.sendRawTransaction(r.serialize(),{skipPreflight:!0});case 40:p=e.sent,console.log(p);case 42:V(ae.PreBet),setTimeout(Object(l.a)(Object(u.a)().mark((function e(){return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:V(ae.PreBet);case 1:case"end":return e.stop()}}),e)}))),12e3),e.next=49;break;case 46:e.prev=46,e.t2=e.catch(10),console.log(e.t2);case 49:case"end":return e.stop()}}),e,null,[[10,46]])}))),12500);case 73:case"end":return n.stop()}}),n,null,[[9,15],[48,55]])})));return function(){return n.apply(this,arguments)}}();return setTimeout(Object(l.a)(Object(u.a)().mark((function t(){var n,r,a,c,s,l;return Object(u.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!W){t.next=26;break}return t.next=3,q.getParsedTokenAccountsByOwner(null===W||void 0===W?void 0:W.publicKey,{mint:new d.PublicKey("rainH85N1vCoerCi4cQ3w6mCf7oYUdrsTFtFzpaRwjL")});case 3:n=t.sent,r=0,a=Object(o.a)(n.value),t.prev=6,a.s();case 8:if((c=a.n()).done){t.next=17;break}return s=c.value,t.next=12,q.getTokenAccountBalance(s.pubkey);case 12:l=t.sent.value.uiAmount,r+=l,l>0&&(e=s.pubkey);case 15:t.next=8;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(6),a.e(t.t0);case 22:return t.prev=22,a.f(),t.finish(22);case 25:i(r);case 26:case"end":return t.stop()}}),t,null,[[6,19,22,25]])}))),500),Object(ce.jsx)(ce.Fragment,{children:Object(ce.jsxs)("main",{className:"container",children:[W&&Object(ce.jsxs)("p",{className:"pp",children:["Balance: ",(c||0).toLocaleString()," $RAIN"]}),Object(ce.jsxs)(oe,{children:[P," is winning! so long as nobody else becomesWinner before ",S]}),Object(ce.jsxs)(oe,{children:["the pot is ",N," $RAIN :D"]}),W&&L==ae.PreBet&&Object(ce.jsx)("div",{children:Object(ce.jsxs)(w.a,{container:!0,spacing:0,children:[Object(ce.jsx)(w.a,{item:!0,xs:4}),Object(ce.jsx)(w.a,{item:!0,xs:4,children:Object(ce.jsx)(oe,{children:Object(ce.jsxs)(x.a,{variant:"outlined",onClick:H,children:[1.02*O*1.01," $RAIN"]})})}),Object(ce.jsx)(w.a,{item:!0,xs:4})]})}),!W&&Object(ce.jsxs)("div",{children:[" ",Object(ce.jsx)(ie,{children:"Connect Wallet"})]}),W&&L==ae.PostBet&&Object(ce.jsx)("div",{children:Object(ce.jsxs)(w.a,{container:!0,spacing:0,children:[Object(ce.jsx)(w.a,{item:!0,xs:4}),Object(ce.jsx)(w.a,{item:!0,xs:4,children:Object(ce.jsx)("h1",{children:"Wait another half a min or 2 or so..."})}),Object(ce.jsx)(w.a,{item:!0,xs:4})]})}),W&&L==ae.RevealPending&&Object(ce.jsx)("div",{children:Object(ce.jsxs)(w.a,{container:!0,spacing:0,children:[Object(ce.jsx)(w.a,{item:!0,xs:4}),Object(ce.jsx)(w.a,{item:!0,xs:4,children:Object(ce.jsx)("h1",{children:"Cool, prob nothing..."})}),Object(ce.jsx)(w.a,{item:!0,xs:4})]})}),Object(ce.jsxs)(w.a,{container:!0,spacing:0,children:[Object(ce.jsx)(w.a,{item:!0,xs:4}),Object(ce.jsx)(w.a,{item:!0,xs:4,children:Object(ce.jsx)("h2",{className:"pp",children:J})}),Object(ce.jsx)(w.a,{item:!0,xs:4})]})]})})},be=n(492),pe=n(493),fe=n(943),he=Object(pe.a)({palette:{type:"dark"},overrides:{MuiButtonBase:{root:{justifyContent:"flex-start"}},MuiButton:{root:{textTransform:void 0,padding:"12px 16px"},startIcon:{marginRight:8},endIcon:{marginLeft:8}}}}),de=function(){var e=Object(r.useMemo)((function(){return"https://ssc-dao.genesysgo.net/"}),[]),t=Object(r.useMemo)((function(){return[Object(be.a)()]}),[]);return Object(ce.jsx)(fe.a,{theme:he,children:Object(ce.jsx)(j.a,{endpoint:e,children:Object(ce.jsx)(j.b,{wallets:t,autoConnect:!0,children:Object(ce.jsx)(v.b,{children:Object(ce.jsx)(le,{})})})})})};i.a.render(Object(ce.jsx)(a.a.StrictMode,{children:Object(ce.jsx)(de,{})}),document.getElementById("root"))}},[[899,1,2]]]);
//# sourceMappingURL=main.4491de81.chunk.js.map